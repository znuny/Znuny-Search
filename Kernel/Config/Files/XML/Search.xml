<?xml version="1.0" encoding="utf-8" ?>
<otrs_config version="2.0" init="Application">
    <Setting Name="SearchEngine::Loader::Engine###000-Framework" Required="0" Valid="1">
        <Description Translatable="1">Registers search engines.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="ES">Elasticsearch</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::Loader::Index::ES###000-Framework" Required="0" Valid="1">
        <Description Translatable="1">Registers search indexes for elastic search engine.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="Ticket">ticket</Item>
                <Item Key="TicketHistory">ticket_history</Item>
                <Item Key="Article">article</Item>
                <Item Key="ArticleDataMIMEAttachment">article_data_mime_attachment</Item>
                <Item Key="DynamicField">dynamic_field</Item>
                <Item Key="DynamicFieldValue">dynamic_field_value</Item>

            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-Ticket-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex</Item>
                <Item Key="Event">TicketTitleUpdate|TicketUnlockTimeoutUpdate|TicketQueueUpdate|TicketTypeUpdate|TicketServiceUpdate|TicketSLAUpdate|TicketPendingTimeUpdate|TicketLockUpdate|TicketStateUpdate|TicketOwnerUpdate|TicketResponsibleUpdate|TicketPriorityUpdate|TicketAccountTime|TicketOwnerSet|ArticleWriteAttachment|TicketCreate|TicketCustomerUpdate</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
                <Item Key="IndexName">Ticket</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Queue::EventModulePost###100-Ticket-Queue-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Ticket::Queue</Item>
                <Item Key="Event">QueueUpdate</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###001-Ticket-DynamicFieldValue-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Ticket::DynamicFieldValue</Item>
                <Item Key="Event">TicketDelete</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###200-Ticket-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex</Item>
                <Item Key="Event">TicketDelete</Item>
                <Item Key="FunctionName">ObjectIndexRemove</Item>
                <Item Key="IndexName">Ticket</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-Article-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Article</Item>
                <Item Key="Event">ArticleCreate</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###001-Article-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Article</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Article</Item>
                <Item Key="Event">ArticleUpdate|TicketMerge</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###002-Article-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Article</Item>
                <Item Key="Event">TicketDelete</Item>
                <Item Key="FunctionName">ObjectIndexRemove</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-Article-ArticleDataMIMEAttachment-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Article::ArticleDataMIMEAttachment</Item>
                <Item Key="Event">ArticleUpdate|ArticleCreate</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-Ticket-ArticleDataMIMEAttachment-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::Ticket::ArticleDataMIMEAttachment</Item>
                <Item Key="Event">TicketDelete</Item>
                <Item Key="FunctionName">ObjectIndexRemove</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-TicketHistory-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::TicketHistory</Item>
                <Item Key="Event">HistoryAdd|TicketMerge</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###001-TicketHistory-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::TicketHistory</Item>
                <Item Key="Event">HistoryDelete</Item>
                <Item Key="FunctionName">ObjectIndexRemove</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="DynamicField::EventModulePost###000-DynamicField-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::DynamicField</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicField</Item>
                <Item Key="Event">DynamicFieldAdd</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="DynamicField::EventModulePost###001-DynamicField-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::DynamicField</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicField</Item>
                <Item Key="Event">DynamicFieldUpdate</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="DynamicField::EventModulePost###002-DynamicField-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::DynamicField</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicField</Item>
                <Item Key="Event">DynamicFieldDelete</Item>
                <Item Key="FunctionName">ObjectIndexRemove</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="DynamicField::EventModulePost###100-DynamicField-Ticket-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicField::Ticket</Item>
                <Item Key="Event">DynamicFieldDelete|DynamicFieldUpdate</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-DynamicFieldValue-Ticket-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicFieldValue</Item>
                <Item Key="Event">TicketDynamicFieldUpdate_*</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
                <Item Key="Field">TicketID</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Ticket::EventModulePost###000-DynamicFieldValue-Article-ObjectIndex" Required="0" Valid="1">
        <Description Translatable="1">Adds index object data of specified operation into search engine indexing queue.</Description>
        <Navigation>Core::Event::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Event::ObjectIndex::DynamicFieldValue</Item>
                <Item Key="Event">ArticleDynamicFieldUpdate</Item>
                <Item Key="FunctionName">ObjectIndexSet</Item>
                <Item Key="Field">ArticleID</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Frontend::Module###AdminSearch" Required="0" Valid="1">
        <Description Translatable="1">Frontend module registration for the agent interface.</Description>
        <Navigation>Frontend::Admin::ModuleRegistration</Navigation>
        <Value>
            <Item ValueType="FrontendRegistration">
                <Hash>
                    <Item Key="GroupRo">
                        <Array>
                        </Array>
                    </Item>
                    <Item Key="Group">
                        <Array>
                            <Item>admin</Item>
                        </Array>
                    </Item>
                    <Item Key="Description">Admin</Item>
                    <Item Key="Title" Translatable="1">Search engine configuration GUI</Item>
                    <Item Key="NavBarName">Admin</Item>
                </Hash>
            </Item>
        </Value>
    </Setting>
    <Setting Name="Loader::Module::AdminSearch###000-Framework" Required="0" Valid="1">
        <Description Translatable="1">Loader module registration for the agent interface.</Description>
        <Navigation>Frontend::Admin::ModuleRegistration::Loader</Navigation>
        <Value>
            <Hash>
                <Item Key="CSS">
                    <Array>
                        <Item>Core.Agent.Admin.Search.css</Item>
                    </Array>
                </Item>
                <Item Key="JavaScript">
                    <Array>
                        <Item>Core.Agent.Admin.Search.js</Item>
                    </Array>
                </Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::Loader::Fields::Ticket###000-Framework" Required="0" Valid="0">
        <Description Translatable="1">Registers example custom mapping for search index Ticket. Priority is used to define which configuration of the same attribute should be taken.</Description>
        <Navigation>Core::Search::Ticket</Navigation>
        <Value>
            <Hash>
                <Item Key="Module">Kernel::System::Search::Object::Extensions::Ticket::CustomPackage</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Frontend::AdminModuleGroups###002-Search" Required="1" Valid="1">
        <Description Translatable="1">Defines available groups for the admin overview screen.</Description>
        <Navigation>Frontend::Base::NavBarModule</Navigation>
        <Value>
            <Hash>
                <Item Key="Search">
                    <Hash>
                        <Item Key="Title" Translatable="1">Search Engine</Item>
                        <Item Key="Order">9000</Item>
                    </Hash>
                </Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Frontend::NavigationModule###AdminSearch" Required="0" Valid="1">
        <Description Translatable="1">Admin area navigation for the admin search engine configuration interface.</Description>
        <Navigation>Frontend::Admin::ModuleRegistration::AdminOverview</Navigation>
        <Value>
            <Hash>
                <Item Key="Group">
                    <Array>
                        <Item>admin</Item>
                    </Array>
                </Item>
                <Item Key="GroupRo">
                    <Array>
                    </Array>
                </Item>
                <Item Key="Module">Kernel::Output::HTML::NavBar::ModuleAdmin</Item>
                <Item Key="Name" Translatable="1">Search Engine</Item>
                <Item Key="Block">Search</Item>
                <Item Key="Description" Translatable="1">Manage search engine clusters.</Item>
                <Item Key="IconBig">fa-search</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine###Enabled" Required="1" Valid="1">
        <Description Translatable="1">Defines if search engine feature should be enabled.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Item ValueType="Checkbox">0</Item>
        </Value>
    </Setting>
    <Setting Name="Daemon::SchedulerCronTaskManager::Task###SearchEngineReindex" Required="0" Valid="1">
        <Description Translatable="1">Cron task for re-indexing active search index cluster with mapping check.</Description>
        <Navigation>Daemon::SchedulerCronTaskManager::Task</Navigation>
        <Value>
            <Hash>
                <Item Key="TaskName">SearchEngineReindex</Item>
                <Item Key="Schedule">0 2 * * *</Item> <!-- Every day at 2am -->
                <Item Key="Module">Kernel::System::Console::Command::Maint::Search::Reindex</Item>
                <Item Key="Function">Execute</Item>
                <Item Key="MaximumParallelInstances">1</Item>
                <Item Key="Params">
                    <Array>
                        <Item>--check-data-equality</Item>
                    </Array>
                </Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="Daemon::SchedulerCronTaskManager::Task###ES-IndexQueueDataProcess" Required="0" Valid="1">
        <Description Translatable="1">Cron task for executing queued operations for active search indexes.</Description>
        <Navigation>Daemon::SchedulerCronTaskManager::Task</Navigation>
        <Value>
            <Hash>
                <Item Key="TaskName">IndexQueueDataProcess</Item>
                <Item Key="Schedule">* * * * *</Item> <!-- Every 1 min -->
                <Item Key="Module">Kernel::System::Console::Command::Maint::Search::ES::IndexQueueDataProcess</Item>
                <Item Key="Function">Execute</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::IndexationQueue###Settings" Required="0" Valid="1">
        <Description Translatable="1">Defines settings used in indexation queue.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="TTL" ValueType="String" ValueRegex="^[0-9]{1,6}$">180</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::Reindexation###Settings" Required="1" Valid="1">
        <Description Translatable="1">Defines settings used in re-indexation command.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="ReindexationStep" ValueType="String" ValueRegex="^[0-9]{1,6}$">500</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::Loader::Index::ES::Plugins###000-Framework" Required="0" Valid="1">
        <Description Translatable="1">Registers Elasticsearch engine plugin.</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="Ingest">Kernel::System::Search::Plugins::ES::Ingest</Item>
            </Hash>
        </Value>
    </Setting>
    <Setting Name="SearchEngine::ES::TicketSearchFields###Fulltext" Required="0" Valid="1">
        <Description Translatable="1">Searchable fields of Ticket index for fulltext search. Use name of ticket, article or attachment field. Dynamic fields can be specified for articles and tickets by setting a value in either Ticket or Article key with a pattern: "DynamicField_NameOfDynamicField".</Description>
        <Navigation>Core::Search</Navigation>
        <Value>
            <Hash>
                <Item Key="Ticket">
                    <Array>
                        <Item>TicketNumber</Item>
                        <Item>Title</Item>
                    </Array>
                </Item>
                <Item Key="Article">
                    <Array>
                        <Item>Body</Item>
                        <Item>Subject</Item>
                        <Item>From</Item>
                        <Item>To</Item>
                        <Item>CC</Item>
                        <Item>BCC</Item>
                    </Array>
                </Item>
                <Item Key="Attachment">
                    <Array>
                        <Item>AttachmentContent</Item>
                        <Item>Filename</Item>
                        <Item>ContentSize</Item>
                    </Array>
                </Item>
            </Hash>
        </Value>
    </Setting>
</otrs_config>
